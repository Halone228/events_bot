# Events Bot

–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram –±–æ—Ç–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ SQLAlchemy 2.0 –∏ aiogram 3.0.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- **–ì–∏–±–∫–æ—Å—Ç—å –ë–î**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL, MySQL –∏ SQLite
- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫**: SQLAlchemy 2.0 —Å async/await
- **–ò–Ω–ª–∞–π–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏
- **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏ (handlers, services, repositories)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

1. **users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram
   - `id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á)
   - `username` - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `first_name`, `last_name` - –ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è
   - `created_at` - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `is_active` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **categories** - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—Å—Ç–æ–≤
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - `description` - –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `is_active` - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

3. **posts** - –ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `title` - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞
   - `content` - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
   - `author_id` - ID –∞–≤—Ç–æ—Ä–∞ (—Å–≤—è–∑—å —Å users)
   - `category_id` - ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Å–≤—è–∑—å —Å categories)
   - `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `is_approved` - –°—Ç–∞—Ç—É—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è
   - `is_published` - –°—Ç–∞—Ç—É—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
   - `published_at` - –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

4. **moderation_records** - –ó–∞–ø–∏—Å–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
   - `id` - –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á
   - `post_id` - ID –ø–æ—Å—Ç–∞
   - `moderator_id` - ID –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
   - `action` - –î–µ–π—Å—Ç–≤–∏–µ (enum: APPROVE=1, REJECT=2, REQUEST_CHANGES=3)
   - `comment` - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
   - `created_at` - –î–∞—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

5. **user_categories** - –°–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### ‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: I/O –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏

### üóÑÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **Connection Pooling**: –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –ë–î
- **Lazy Loading**: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
- **–ò–Ω–¥–µ–∫—Å—ã**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **Batch Operations**: –ì—Ä—É–ø–ø–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üì± Telegram API –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **Inline-–∫–Ω–æ–ø–∫–∏**: –ë—ã—Å—Ç—Ä–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- **Callback Queries**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **Message Editing**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤–º–µ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö

### üöÄ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞
- **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞**: < 100ms –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**: 1000+ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**: < 50MB –¥–ª—è –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞**: < 5 —Å–µ–∫—É–Ω–¥ —Å —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.12+
- SQLAlchemy 2.0+
- PostgreSQL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), MySQL –∏–ª–∏ SQLite

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
uv sync
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –î–ª—è SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python main.py

# –î–ª—è PostgreSQL
export DATABASE_URL="postgresql://user:password@localhost/events_bot"
python main.py

# –î–ª—è MySQL
export DATABASE_URL="mysql://user:password@localhost/events_bot"
python main.py

# –î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±–æ—Ç–∞ (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –±–∞–∑–∞ –≤ –ø–∞–º—è—Ç–∏)
TEST_MODE=true python test_bot.py

### üê≥ Docker

```bash
# –ü—Ä–æ–¥–∞–∫—à–Ω —Å PostgreSQL
docker-compose --profile production up -d

# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
docker-compose --profile test up -d

# Podman (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ Docker)
podman-compose --profile production up -d
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
events_bot/
‚îú‚îÄ‚îÄ events_bot/
‚îÇ   ‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start_handler.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_handlers.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post_handlers.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ callback_handlers.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ moderation_handlers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards/         # –ò–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ states/           # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ       ‚îú‚îÄ‚îÄ models.py         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ repositories/     # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ       ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ connection.py     # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ test_bot.py              # –¢–µ—Å—Ç–æ–≤—ã–π –±–æ—Ç
‚îú‚îÄ‚îÄ docker-compose.yaml      # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```


```
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è

## API –û—Å–Ω–æ–≤–Ω—ã—Ö –ö–ª–∞—Å—Å–æ–≤

### UserService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `register_user()` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `select_categories()` - –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `get_user_categories()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### PostService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `create_post()` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
- `get_user_posts()` - –ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `get_posts_by_categories()` - –ü–æ—Å—Ç—ã –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- `approve_post()` - –û–¥–æ–±—Ä–µ–Ω–∏–µ –ø–æ—Å—Ç–∞
- `reject_post()` - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–∞

### CategoryService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `get_all_categories()` - –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `get_category_by_id()` - –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ ID

### ModerationService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `get_moderation_queue()` - –û—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `format_post_for_moderation()` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏

### NotificationService (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `get_users_to_notify()` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ø–æ –≥–æ—Ä–æ–¥—É –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
- `format_post_notification()` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

- `DATABASE_URL` - URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- `BOT_TOKEN` - –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö

- **PostgreSQL**: `postgresql://user:pass@host/db` ‚Üí `postgresql+asyncpg://user:pass@host/db`
- **MySQL**: `mysql://user:pass@host/db` ‚Üí `mysql+aiomysql://user:pass@host/db`
- **SQLite**: `sqlite:///./db.sqlite` ‚Üí `sqlite+aiosqlite:///./db.sqlite`

## –ü—Ä–∏–º–µ—Ä Mapped –°—Ç–∏–ª—è

```python
from sqlalchemy.orm import Mapped, mapped_column
from typing import Optional

class User(Base, TimestampMixin):
    __tablename__ = 'users'
    
    # –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è
    id: Mapped[int] = mapped_column(primary_key=True)
    username: Mapped[Optional[str]] = mapped_column(String(100), nullable=True)
    is_active: Mapped[bool] = mapped_column(Boolean, default=True)
    
    # –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤—è–∑–∏
    posts: Mapped[List["Post"]] = relationship(back_populates="author")
```

## –ó–∞–ø—É—Å–∫ –ë–æ—Ç–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   uv sync
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   export BOT_TOKEN="your_telegram_bot_token"
   export DATABASE_URL="sqlite+aiosqlite:///./events_bot.db"  # –∏–ª–∏ –¥—Ä—É–≥–∞—è –ë–î
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
   ```bash
   uv run python main.py
   ```

### Docker –∑–∞–ø—É—Å–∫

1. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   cp env.example .env
   ```

2. **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª:**
   ```bash
   nano .env
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é —Å SQLite:**
   ```bash
   podman-compose --profile test up bot-test
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–¥–∞–∫—à–Ω –≤–µ—Ä—Å–∏—é —Å PostgreSQL:**
   ```bash
   podman-compose --profile production up
   ```

### Docker/Podman –∫–æ–º–∞–Ω–¥—ã

- **–°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞:**
  ```bash
  podman build -t events-bot .
  ```

- **–ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –±–æ—Ç–∞:**
  ```bash
  podman run --env-file .env events-bot
  ```

- **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:**
  ```bash
  podman-compose logs -f bot
  ```

- **–û—Å—Ç–∞–Ω–æ–≤–∫–∞:**
  ```bash
  podman-compose down
  ```

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

–ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Å Docker, —Ç–∞–∫ –∏ —Å Podman:
- `docker-compose` ‚Üí `podman-compose`
- `docker build` ‚Üí `podman build`
- `docker run` ‚Üí `podman run`

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- **Connection pooling**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–ª–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **Lazy loading**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- **Batch operations**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
